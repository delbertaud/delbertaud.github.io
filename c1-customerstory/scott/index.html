
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Search page</title>		
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="description" content="">
		<meta name="author" content="">
		<link rel="stylesheet" href="css/style.css">
		<link href='https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css' rel='stylesheet'>
		<link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.css' rel='stylesheet'>
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@200;300;400;500;600;700&display=swap" rel="stylesheet">
		<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script>
		<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
		<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
	</head>	
	<body>	
		<div id="div1">
			<div class="bg" id="first">						
				<div class="col-12 col-md-12 col-lg-12 col-xl-12 mx-auto searh-page">
					<nav class="navbar navbar-expand-lg navbar-light p-0 m-0" id="home-btn">					
						<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
						<span class="navbar-toggler-icon"></span>
						</button>				  
						<div class="collapse navbar-collapse" id="navbarNav">
							<ul class="navbar-nav">
								<li class="nav-item"></li>
								<li class="nav-item">						
									<button id="showAboutButton" class="btn btn-abt btn-md my-2 my-sm-0">ABOUT</button>
								</li>					
							</ul>					
						</div>				 
					</nav>
					<div id="aboutDiv">	
						<button id="closeAboutButton" class="btn btn-home btn-md my-2 my-sm-0">HOME</button>
						<iframe id="aboutIFrameURL" src='about.html' width="100%" class="z-border"></iframe>
					</div>				
				</div>
				<div class="col-12 col-md-9 col-lg-7 col-xl-5 mx-auto pt-5">						
					<div id="searchDiv">       
						<div class="heading text-center mb-5">Welcome To The <span class="s-blue">Customer Story</span></div>
						<h5 class="text-center">Company Code or Name</h5>
						<form class="form-inline">		
							<div class="form-group col-sm-10">
								<div id="searchbar">									
									<input id="searchForTextbox" type="text" class="searchFor width adj-h" autocomplete="off">
									<select id="companyList" size="10" class="width"></select>								
								</div>
							</div>
							<div class="form-group col-sm-2 pl-sm-0">
								<input  type="submit" disabled class="btn btn-blue adj">
								<button id='submitButton' type="button" class="btn btn-blue adj">Submit</button>
							</div>				 
						</form>					
					</div>									
				</div>	
				<div class="col-12 col-md-12 col-lg-12 col-xl-12 mx-auto searh-page">				
					<div id="aboutDiv" class="pt-5">	
					<button id="closeAboutButton" class="btn btn-home btn-md my-2 my-sm-0">HOME</button>					
					<iframe id="aboutIFrameURL" src='about.html' width="100%" class="z-border"></iframe>
				</div>				
			</div>
		</div>
	</div>

		
	<div id="contentIframeDiv">	
		<div class="content-wrapper pt-1">
			<div class="container-fluid">				
				<nav class="navbar navbar-expand-lg p-0 navbar-light">
					<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
						<span class="navbar-toggler-icon"></span>
					</button>
					<div class="collapse navbar-collapse " id="navbarTogglerDemo01">						
						<ul class="navbar-nav ml-auto">														
							<li class="nav-item mr-2">								
								<button class="btn btn-custom btn-sm my-2 my-sm-0" id="closeContentIFrameButton">HOME</button>
							</li>
							<li class="nav-item mr-2">
								<button id="projects" class="btn btn-custom btn-sm my-2 my-sm-0">PROJECTS</button>
							</li>
							<li class="nav-item mr-2">
								<button id="tickets" class="btn btn-custom btn-sm my-2 my-sm-0">TICKETS</button>
							</li>
							<li class="nav-item">
								<button id="oppourtunities" class="btn btn-custom btn-sm my-2 my-sm-0">OPPORTUNITIES</button>
							</li>  							
						</ul>						
					</div>
				</nav>	
				<hr class="mt-1 mb-1">
					<div id="test">
						<iframe id="contentIFrameURL" src='' class="m-90" width="100%"></iframe>
					</div>
			</div>
		</div>			
	</div>	
		
	<script>
		document.getElementById("submitButton").addEventListener("click", showContentIFrameDiv);
		document.getElementById("showAboutButton").addEventListener("click", showAboutDiv)
		document.getElementById("closeAboutButton").addEventListener("click", closeAboutDiv)
		document.getElementById("closeContentIFrameButton").addEventListener("click", closeContentIFrameDiv)
		document.getElementById("projects").addEventListener("click", chanagetoprojectsifarme)
		document.getElementById("tickets").addEventListener("click", chanagetoticketsifarme)
		document.getElementById("oppourtunities").addEventListener("click", chanagetooppourtunitiesifarme)		
		findCompanies();
		function findCompanies() {
			document.getElementById("submitButton").disabled = true;
			searchForValue = document.getElementById("searchForTextbox").value.toLowerCase();
			url = "https://customerstory.onguard.convergeone.com/csapi/" + searchForValue;
			var xmlHttp = new XMLHttpRequest();
			xmlHttp.onreadystatechange = function() { 
				if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {
				findCompaniesCallBack(xmlHttp.responseText);
					}
				}
				xmlHttp.open("GET", url, true); 
				xmlHttp.send(null);
				return false; 
			}
			function findCompaniesCallBack(response) {
				contents = "";
				data = JSON.parse(response);
				data.forEach(function(element) { contents += `<option value="${element}">${element}</option>` });
				document.getElementById("companyList").innerHTML = contents;
			}
			document.getElementById("searchForTextbox").onkeyup = function(e) {
				if (!e) e = window.event;
				keyCode = e.code || e.key;
				if (keyCode == "Tab") {
					return;
				}
				if (keyCode == "ArrowDown"){
					document.getElementById("companyList").focus()
					return;
				}
				if (keyCode == "ArrowUp" || keyCode == "ArrowRight" || keyCode == "ArrowLeft"){
					return;
				}
				findCompanies();
			}
			document.getElementById("companyList").onfocus = function(e) {
				if (document.getElementById("companyList").selectedIndex == -1) {
					document.getElementById("companyList").selectedIndex = 0;
					document.getElementById("submitButton").disabled = false;
					document.getElementById("searchForTextbox").value = document.getElementById("companyList").selectedOptions[0].innerText;
				}
			}
			document.getElementById("companyList").onchange = function(e) {
				document.getElementById("searchForTextbox").value = document.getElementById("companyList").selectedOptions[0].innerText;
				document.getElementById("submitButton").disabled = false;
			}

			function showAboutDiv() {
				document.getElementById("searchDiv").style.display = "none";
				document.getElementById("aboutDiv").style.display = "block";
				document.getElementById("home-btn").style.display = "none";
			}
			function closeAboutDiv() {
				document.getElementById("aboutDiv").style.display = "none";
				document.getElementById("searchDiv").style.display = "block";				
				document.getElementById("home-btn").style.display = "block";				
			}
			function showContentIFrameDiv() {
				document.getElementById("div1").style.display = "none";
				document.getElementById("contentIframeDiv").style.display = "block";
				customerCode = document.getElementById("companyList").selectedOptions[0].innerText.split(":")[1]
				chanagetoprojectsifarme()
			}
			function closeContentIFrameDiv() {
				document.getElementById("contentIframeDiv").style.display = "none";
				document.getElementById("div1").style.display = "block";
				
			}
			function chanagetoprojectsifarme() {
				document.getElementById("projects").style.color = "blue";
				document.getElementById("tickets").style.color = "black";
				document.getElementById("oppourtunities").style.color = "black";
				document.getElementById("contentIFrameURL").src = "https://dashboard.onguard.convergeone.com/s/proservices/app/dashboards#/view/fe93f800-f942-11eb-8b4b-e5e8a06f8cf5?embed=true&_g=(filters:!(),refreshInterval:(pause:!t,value:0),time:(from:now-10y,to:now))&_a=(description:%27%27,filters:!((%27$state%27:(store:appState),query:(match_phrase:(CustomerId.keyword:"+customerCode+")))),fullScreenMode:!f,options:(hidePanelTitles:!f,useMargins:!t),query:(language:kuery,query:%27%27),timeRestore:!t,title:%27Account%20Project%20Overview%27,viewMode:view)";
			}
			function chanagetoticketsifarme() {
				document.getElementById("projects").style.color = "black";
				document.getElementById("tickets").style.color = "blue";
				document.getElementById("oppourtunities").style.color = "black";
				document.getElementById("contentIFrameURL").src = "https://dashboard.onguard.convergeone.com/s/csc-reporting/app/dashboards#/view/fcab4af0-f6b1-11ea-abc0-c9004f495d28?embed=true&_g=(filters%3A!()%2CrefreshInterval%3A(pause%3A!t%2Cvalue%3A0)%2Ctime%3A(from%3Anow-90d%2Cto%3Anow))&_a=(description:%27%27,filters:!((%27$state%27:(store:appState),query:(match_phrase:(companycode:"+customerCode+")))),fullScreenMode:!f,options:(hidePanelTitles:!f,useMargins:!t),query:(language:kuery,query:%27%27),timeRestore:!t,title:%27SWB%20-%20Customer%20Alarms%20and%20Customer%27,viewMode:view)";
			}
			function chanagetooppourtunitiesifarme() {
				document.getElementById("projects").style.color = "black";
				document.getElementById("tickets").style.color = "black";
				document.getElementById("oppourtunities").style.color = "blue";
				document.getElementById("contentIFrameURL").src = "comingsoon.html";
			}
	</script>
	<script type='text/javascript' src='https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.bundle.min.js'>
	</script>			
	</body>
</html>
